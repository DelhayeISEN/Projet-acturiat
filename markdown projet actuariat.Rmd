---
title: "projet actuariat"
author: "Delhaye"
date: "19/03/2020"
output: html_document
---

### Installation des packages utilisées dans ce projet 

```{r}
#install.packages(c("xts","sp","zoo"))
#install.packages("Hmisc")
```


### Installation du package CASdatasets contenant les 2 jeux de données sur lesquels nous allons travaillés

```{r}
#install.packages("CASdatasets", repos = "http://dutangc.free.fr/pub/RRepos/", type="source")
```

### Importation des librairies nécessaires aux datasets

```{r}
library(zoo)
library(xts)
library(sp)
library(CASdatasets)
```

### Chargement des 2 jeux de données freMPL1 et freMPL2

```{r}
data(freMPL1)
data(freMPL2)
```

Un peu à la manière du machine learning, les données contenues dans freMPL2 serviront de données d'entraînement de notre modèle et les données de freMPL1 serviront pour tester notre modèle final.

# 1. Explorez les données freMPL1 et freMPL2 à l'aide des techniques exploratoires usuelles (statistiques descriptives, ACP, AFC)

### freMPL1

```{r}
head(freMPL1)
summary(freMPL1)
```

### Exploration du jeu de données d'entraînement : freMPL2

Dans un premier temps, regardons les premières lignes du jeu de données 
```{r}
head(freMPL2)
```
 et les dimmensions de notre jeu de données : 
```{r}
dim(freMPL2)
```
 Le jeu contient 48295 données différentes, toutes définies par 22 caractéristiques différentes. 

Affichons les différents noms des colonnes : 
```{r}
colnames(freMPL2)
```

Regardons maintenant les différents types d'objets figurant dans les colonnes :  
```{r}
str(freMPL2)
```
Nous avons donc des objets de type numeric, de type factor, de type int et même de type date. 

Regardons maintenant plus précisement les valeurs particulières de ces colonnes (valeurs minimum et maximum, moyenne, médiane,quantiles, ...)

```{r}
summary(freMPL2)
```

On peut aussi utiliser la méthode describe du package Hmisc pour avoir un aperçu de la dispersion des données.
```{r}
library("Hmisc")
describe(freMPL2)
```
Mais cela ne vaut pas une représentation graphique. 

###### Représentations graphiques des données

```{r}
# effectif

hist(freMPL1$LicAge, 
      col = c("orange"),
      main = paste("Histogramme pour la variable LicAge"),
      ylab = "Effectifs",
      xlab = "Licence Age in months ")

# Proportion
table_Garage<-table(freMPL1$Garage)
barplot(table_Garage, main="Répartition des garages", 
        xlab="Nombre de garages",
        col="orange")
```

```{r}
#calibration d’une loi de Poisson
fpois <- glm(RiskVar~DrivAge+VehAge+VehClass+VehBody+VehEnergy+Gender, offset=log(Exposure), family=poisson("log"), data=freMPL2)
summary(fpois)

#calibration d’une loi Poisson sur-dispersée
fpois2 <- glm(RiskVar~DrivAge+VehAge+VehClass+VehBody+VehEnergy+Gender, offset=log(Exposure), family=quasipoisson("log"), data=freMPL2)
summary(fpois2)
```
